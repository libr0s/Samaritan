swagger: '2.0'
info:
  description: Dokumentacja api naszego projektu zawierająca specyfikacje danych endpointów. Do wszystkich endpointów poza rejestracją i logowaniem, powinien być dołączony token autoryzacyjny w nagłówku zapytania postaci 'Bearer <wartość tokena>'. Zapytanie bez ważnego tokena skutkuje response z kodem 400.
  version: 1.0.0
  title: Samaritan - dokumentacja api
host: '127.0.0.1:8000'
schemes:
  - http
paths:
  /registration:
    post:
      summary: Rejestracja nowego użytkownika
      consumes:
        - application/json
      parameters:
        - name: Konto wolontariusza
          in: body
          description: 'Dane wolonatriusza, którego konto chcemy stworzyć'
          schema:
            type: object
            required:
              - email
            properties:
              type:
                type: string
                enum:
                  - volunteer
              email:
                type: string
              password:
                type: string
              name:
                type: string
              surname:
                type: string
        - name: Konto organizacji
          in: body
          description: 'Dane organizacji, której konto chcemy stworzyć'
          schema:
            type: object
            required:
              - email
            properties:
              type:
                type: string
                enum:
                  - organization
              email:
                type: string
              password:
                type: string
              name:
                type: string
              city:
                type: string
              post_code:
                type: string
      responses:
        '200':
          description: użytkownik został utworzony
        '400':
          description: dane użytkownika nie są poprawne
          schema:
            $ref: '#/definitions/GrandParent'
    get:
      summary: Tymczasowe zwrócenie danych wszystkich użytkowników
      responses:
        '200':
          description: poprawne zwrócenie danych
  /login:
    post:
      summary: Logowanie użytkownika
      consumes:
        - application/json
      parameters:
        - name: Logowanie użytkownika
          in: body
          description: Dane użytkownika do logowania
          schema:
            type: object
            required:
              - email
            properties:
              email:
                type: string
              password:
                type: string
      responses:
        '200':
          description: użytkownik zalogowany poprawnie
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - Successfully logged in
              access_token:
                type: string
        '400':
          description: dane użytkownika nie są poprawne
  /logout:
    post:
      summary: Wylogowywanie użytkownika
      responses:
        '200':
          description: użytkownik wylogowany poprawnie
        '500':
          description: 'użytkownik nie został wylogowany, błąd serwera'
  /profile:
    get:
      summary: Profil użytkownika
      responses:
        '200':
          description: Profil użytkownika bądź organizacji
          schema:
            type: object
            properties:
              id:
                type: integer
                enum:
                  - 1
              name:
                type: string
                enum:
                  - Janek
              surname:
                type: string
                enum:
                  - Testowy
              points:
                type: integer
                enum:
                  - 0
              rank:
                type: string
                enum:
                  - Jamnik
        '400':
          description: Brak tokenu autoryzacyjnego
        '500':
          description: 'Nie można zwrócić profilu, błąd serwera'
  /actions:
    get:
      summary: Ogólna obsługa akcji
      responses:
        '200':
          description: 'Lista wszystkich akcji, jako tablica'
    post:
      summary: Dodawanie nowych akcji
      responses:
        '201':
          description: Akcja stworzona
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - 'Stowrzono akcje id: 1'
        '500':
          description: Błąd serwera
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - Blad serwera
  '/action/{id_akcji}':
    get:
      summary: Pobranie akcji o numerze
      responses:
        '200':
          description: Zwrócona akcja o zadanym ip
          schema:
            type: object
            properties:
              id:
                type: integer
                enum:
                  - 1
              name:
                type: string
                enum:
                  - akcja testowa
              organisation:
                type: string
                enum:
                  - Organizacja jamnik
              points:
                type: integer
                enum:
                  - 120
              date:
                type: string
                enum:
                  - '2018-01-27'
        '404':
          description: Nie znaleziono akcji
          schema:
            type: object
            properties:
              message:
                type: integer
                enum:
                  - 'Akcja o zadanym id nie istnieje :c'
    put:
      summary: Usuwanie akcji
      parameters:
        - in: body
          name: body
          description: Pet object that needs to be added to the store
          required: false
          schema:
            $ref: "#/definitions/Pet"
      responses:
        '200':
          description: Akcja stworzona
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - 'Akcje o id: 1 zmodyfikowana.'
        '403':
          description: Próba usunięcia nie swojej akcji
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - To nie jest akcja twojej organizacji
        '500':
          description: Błąd serwera
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - Blad serwera
    delete:
      summary: Usuwanie akcji
      responses:
        '200':
          description: Akcja stworzona
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - 'Akcje o id: 1 usunieta.'
        '403':
          description: Próba usunięcia nie swojej akcji
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - To nie jest akcja twojej organizacji
        '500':
          description: Błąd serwera
          schema:
            type: object
            properties:
              message:
                type: string
                enum:
                  - Blad serwera
  '/partitcipation/{id_akcji}':
    post:
      summary: Dołączenie zalogowanego użytkownika do akcji o danym id
      consumes:
        - application/json
      responses:
        '200':
          description: Użytkownik dołączył do danej akcji
        '404':
          description: Dana akcja nie istnieje
        '400':
          description: Użytkownik nie może być zapisany do danej akcji, ponieważ już jest do niej zapisany lub akcja się zakończyła
    delete:
      summary: Anulowanie udziału zalogowanego użytkownika w akcji o danym id
      responses:
        '200':
          description: poprawne anulowanie udziału
        '400':
          description: użytkownik nie jest zapiany do tej akcji lub akcja się zakończyła
  '/participation':
    get:
      summary: Zwrócenie wszystkich akcji do których jest zapisany zalogowany wolontariusz
      responses:
        '200':
          description: poprawne zwrócenie wszystkich akcji w tablicy
        '404':
          description: użytkownik nie jest zapisany do żadnych akcji 
  '/participations':
    get:
      summary: Zwrócenie wszystkich wolontraiuszy zapisanych do danej akcji
      responses:
        '200':
          description: poprawne zwrócenie wszystkich wolontariusz w tablicy
        '404':
          description: do danej akcji nikt nie jest zapisany 
  '/grading':
    post:
      summary: Przyznanie punktów danemu wolontariuszowi za zakończoną akcje
      consumes:
        - application/json
      parameters:
        - name: body
          in: body
          description: JSON z danymi wolontariusz, akcji oraz liczbą przyznanych punktów
          schema:
            properties:
              volunteer_id:
                type: string
              action_id:
                type: string
              points:
                type: string
      responses:
        '200': 
          description: punkty zostały poprawnie przyznane
        '403':
          description: próba przyznania punktów za akcję innej organizacji
        '400':
          description: dana akcja się nie zakończyła
        '404':
          description: wolontariusz nie uczestniczy w danej akcji lub został już oceniony
    get:
      summary: Zwrócenie wszystkich ocenionych lub nieocenionych wolontariuszy w danej akcji
      parameters:
        - in: path
          name: action_id
          type: integer
          required: true
          description: Numer id akcji, której wolontariuszy chcemy wyszukać
        - in: path
          name: grade
          type: boolean
          required: true
          description: True- zwróceni zostaną ocenieni wolontariusze w danej akcji, False- zwróceni zostaną nieocenieni wolontariusze w danej akcji
      responses: 
        '200': 
          description: Zwrócenie listy wolontariuszy
        '404':
          description: brak wolontariuszy spełniających kryteria  
      
definitions:
  GrandParent:
    type: object
    properties:
      message:
        $ref: '#/definitions/message'
  Action:
    properties:
      name:
        type: string
      points:
        type: integer
        format: int64
      start_date:
        type: string
        format: date
      end_date:
        type: string
        format: date
      geo:
        $ref: '#/definitions/GeoLoc'
  GeoLoc:
    properties:
      name:
        type: string
      address:
        type: string
      type:
        type: string
      lat:
        type: float
      lng:
        type: float
  message:
    type: object
    properties:
      email:
        type: array
        items:
          type: string
          enum:
            - Not a valid email
      name:
        type: array
        items:
          type: string
          enum:
            - Not a valid name
      post_code:
        type: array
        items:
          type: string
          enum:
            - Not a valid post code

